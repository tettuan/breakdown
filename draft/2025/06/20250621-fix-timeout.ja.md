「プロジェクトの目的」に沿って、「足元のタスクとゴール」を完了させてください。
「チームの構成」を踏まえ、最大効率で「足元のタスクとゴール」を完了させてください。

# プロジェクトの目的

`Breakdown` アプリケーションを完成に導くことです。

## ブランチ

`main` での作業は禁止。

**作業前に**: 
プロジェクトの目的に従い、ブランチを作成し、移動します。(すでに移動済みなら、そのまま。)

# チームの構成
あなたは指揮官であり上司である。
各paneに部下がいるので、チームを立ち上げて進める。

`instructions/team-head.ja.md` に詳細の記載がある。
チーム立ち上げの指示なので、必ず最初に読むこと。

# プロジェクトの実行

## タスクとゴール

タイムアウトを環境変数に依存させず、STDINテストを完成させる。

```yml
- 信じて良い前提: Breakdown本体は正常に動作する
- 作業対象: テストと examples の両方を走査
- タスク: タイムアウトを環境変数に依存させず、STDINテストを完成させる。
- 作業リスト:
  - テストを環境変数で分岐させず、環境変数を全て消す。
  - 標準入力をテストする。
  - タイムアウトする理由を明確にする。INPUTがあればタイムアウトしないはずである。
  - テストを複数のステップに分けて、STDINの渡し方別にテストする
  - STDINのテストは１フォルダへまとめる
- 解決すべき課題: 
  - "CI用のSTDIN環境変数": 環境依存させずSTDINを使う
  - "タイムアウト問題": STDINがタイムアウトする理由を洗い出す。
- "標準のタイムアウト": Denoが環境依存せずタイムアウト処理は残す。（環境依存しない共通処理）
- ゴール: 環境依存のCI変数が全て削除されている。テストが全てpassしている。
```


### 環境変数のリスト

以下の設定がSTDIN処理で使われている。
この処理を一掃する。STDINは標準でテストされ、タイムアウト問題を入力値がないことに求めて解決して。
コメントされている箇所からも一掃して。

```
## 環境変数設定早見表

| 環境変数 | 用途 | 値 | 説明 |
|---------|------|----|----- |
| `CI` | CI判定 | true/false | CI環境の基本判定 |
| `CI_STDIN_BEHAVIOR` | CI動作制御 | strict/permissive/disabled | CI環境でのstdin動作モード |
| `CI_STDIN_TIMEOUT` | CIタイムアウト | ミリ秒 | CI環境専用タイムアウト値 |
| `TEST_STDIN_AVAILABLE` | テスト制御 | true/false | テスト環境でのstdin利用可否 |
| `TEST_STDIN_MOCK` | テストモック | true/false | モックstdinの使用 |
| `STDIN_DEBUG` | デバッグ | true/false | stdin関連のデバッグログ |
| `STDIN_DEBUG_LEVEL` | ログレベル | minimal/standard/verbose | デバッグログの詳細度 |
| `FORCE_NON_INTERACTIVE` | 強制制御 | true/false | 非インタラクティブ強制 |
| `SKIP_STDIN_CHECK` | チェック制御 | true/false | stdin チェックのスキップ |
```

**注意書き**
実行前に、 `examples/README.ja.md` を読むこと。
実行後、結果ログファイルを分析し、同じ階層にサマリーも保存すること。

### 必読資料

- アーキテクチャ `docs/breakdown/architecture.ja.md` に照らして判断する。
- 用語集は `docs/breakdown/glossary.ja.md` にある。
- その他仕様書は docs/ 配下にある。

### 完了条件

以下の3点です。

- 存在する examples/* を0から順番に実行した結果、最後までエラーなく完了する
- lib/, tests/ のテストが全て pass する
- `deno task ci` が1つのエラーもなく成功する

## タスクの進め方

- サイクル: 仕様把握 → 調査 → 計画・設計 → 実行 → 記録・検証 → 学習 → 仕様把握へ戻る
- サイクル段階に応じて、メンバーの役割を変更し最適アサイン。常時フル稼働を目指す。

### 伝達係: 状況把握と方針伝達
伝達係が行う「サマリー」の伝達とは、次のことです。

- 1状況あたり:
  - 文字数:100文字以内
  - 内容: 次の２点を完結に表現。1.成功してわかったこと, 2.失敗して避けるべきこと
- 保存先: `tmp/summary.md`
  - 最初に指揮官がリセットしておく
- 更新頻度: 
  - 追加: 部下からの報告で分かったことが増える都度
  - 圧縮: 単なる途中経過や矛盾点を消し込む
  - 圧縮頻度: 追加10回に1回程度


### エラー対応

- 総司令官とマネージャーが決める役。メンバーは実行役。
  - エラー前比で、2倍広い範囲で仕様理解する。
  - 仕様理解に必要な作業自体はメンバーへ依頼する。
- マネージャーと総司令官で議論して、対応を決める

テストコードを疑うときは、テストの意図を、設計の意図と合わせて考え、
最適な結論を導き出してテスト修正する。

**禁止事項**
lib/ 配下と tests/ 配下は変更禁止。

### 進捗更新

- 進捗させるべきタスクは `tmp/tasks.md` に書き出し、完了マークをつけたりしながら進めてください。
- テストは、 `deno task ci` を実行して、local で CIが通ることを確認してください。

すべてが完了したら、`tmp/completed.md` に完了したレポートを記録してください。


# 開始指示

まずチームを立ち上げます。
タスクを適切に分解し、チーム全体のパフォーマンス向上が重要です。
あなたはそのためにメンバーとマネージャーを活躍させてください。

パフォーマンス最大化のためには、今なにをすべきか（タスク分割や、状況整理、要件定義）が重要です。
今やることに応じて、部下には適切な役割を割り当ててください。

プロジェクトの成功を祈ります。開始してください。


